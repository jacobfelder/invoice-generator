<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Coldbruh Invoice Generator</title>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  background: #f5f5f5;
}

header {
  background: #111;
  color: white;
  padding: 15px 25px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

header h1 {
  font-size: 18px;
  margin: 0;
}

header button {
  margin-left: 10px;
  padding: 8px 14px;
  border: none;
  cursor: pointer;
  background: #fff;
  color: #111;
  font-weight: 600;
}

.container {
  max-width: 1000px;
  margin: 30px auto;
  background: white;
  padding: 30px;
}

input, textarea {
  padding: 6px;
  width: 100%;
  box-sizing: border-box;
  margin-bottom: 8px;
}

.small-input {
  width: 80px;
  text-align: right;
}

.top-grid {
  display: flex;
  gap: 40px;
  margin-bottom: 25px;
}

.top-left, .top-right {
  flex: 1;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
}

th, td {
  border: 1px solid #ddd;
  padding: 8px;
}

th {
  background: #f0f0f0;
}

.right {
  text-align: right;
}

.totals {
  margin-top: 20px;
  max-width: 300px;
  margin-left: auto;
}

.totals div {
  margin-bottom: 5px;
}

.hidden {
  display: none;
}

.invoice-preview h2 {
  margin-top: 0;
}

.invoice-header {
  display: flex;
  justify-content: space-between;
  margin-bottom: 30px;
}

.logo {
  font-size: 24px;
  font-weight: bold;
}

@media print {
  header {
    display: none;
  }
  body {
    background: white;
  }
  .container {
    margin: 0;
    padding: 0;
  }
  .editor {
    display: none !important;
  }
}
</style>
</head>
<body>

<header>
  <h1>Coldbruh Invoice Generator</h1>
  <div>
    <button onclick="showEditor()">Edit</button>
    <button onclick="showPreview()">Preview</button>
    <button onclick="window.print()">Print</button>
  </div>
</header>

<div class="container">

  <!-- EDITOR -->
  <div id="editor" class="editor">

    <div class="top-grid">
      <div class="top-left">
        <label>Invoice #</label>
        <input id="invoiceNumber" />

        <label>Invoice Date</label>
        <input type="date" id="invoiceDate" />

        <label>Due Date</label>
        <input type="date" id="dueDate" />
      </div>

      <div class="top-right">
        <label>Bill To</label>
        <input id="customerName" placeholder="Customer Name" />
        <textarea id="customerAddress" placeholder="Customer Address"></textarea>
        <input id="customerEmail" placeholder="Customer Email" />
      </div>
    </div>

    <h3>Line Items</h3>

    <table id="itemsTable">
      <thead>
        <tr>
          <th>Description</th>
          <th class="right">Qty</th>
          <th class="right">Price</th>
          <th class="right">Total</th>
          <th></th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <button onclick="addItem()">Add Item</button>

    <div class="totals">
      <div>Subtotal: $<span id="eSubtotal">0.00</span></div>
      <div>
        Tax:
        <input type="number" id="taxRate" class="small-input" value="0" step="0.01"> %
        = $<span id="eTax">0.00</span>
      </div>
      <div><strong>Total: $<span id="eTotal">0.00</span></strong></div>
    </div>

  </div>

  <!-- PREVIEW -->
  <div id="preview" class="invoice-preview hidden">

    <div class="invoice-header">
      <div>
        <div class="logo">Coldbruh</div>
        <div>123 Brew Street</div>
        <div>Brooklyn, NY</div>
        <div>coldbruh@email.com</div>
      </div>
      <div>
        <h2>Invoice</h2>
        <div><strong>#:</strong> <span id="pInvoiceNumber"></span></div>
        <div><strong>Date:</strong> <span id="pInvoiceDate"></span></div>
        <div><strong>Due:</strong> <span id="pDueDate"></span></div>
      </div>
    </div>

    <h3>Bill To</h3>
    <div id="pCustomerName"></div>
    <div id="pCustomerAddress"></div>
    <div id="pCustomerEmail"></div>

    <table>
      <thead>
        <tr>
          <th>Description</th>
          <th class="right">Qty</th>
          <th class="right">Price</th>
          <th class="right">Total</th>
        </tr>
      </thead>
      <tbody id="pItems"></tbody>
    </table>

    <div class="totals">
      <div>Subtotal: $<span id="pSubtotal"></span></div>
      <div>Tax: $<span id="pTax"></span></div>
      <div><strong>Total: $<span id="pTotal"></span></strong></div>
    </div>

    <div style="margin-top:40px;">
      <strong>Payment Terms:</strong><br>
      Payment due within 14 days.<br>
      Zelle: coldbruh@email.com
    </div>

  </div>

</div>

<script>

const today = new Date().toISOString().split("T")[0];
document.getElementById("invoiceDate").value = today;
document.getElementById("dueDate").value = today;

let invoiceCounter = localStorage.getItem("invoiceCounter") || 1;
document.getElementById("invoiceNumber").value = invoiceCounter;

function addItem(desc="", qty=1, price=0) {
  const tbody = document.querySelector("#itemsTable tbody");
  const row = document.createElement("tr");

  row.innerHTML = `
    <td><input value="${desc}"></td>
    <td><input type="number" value="${qty}" min="1" class="right"></td>
    <td><input type="number" value="${price}" step="0.01" class="right"></td>
    <td class="right">$0.00</td>
    <td><button onclick="this.closest('tr').remove(); calculate();">X</button></td>
  `;

  tbody.appendChild(row);

  row.querySelectorAll("input").forEach(input =>
    input.addEventListener("input", calculate)
  );

  calculate();
}

function calculate() {
  let subtotal = 0;

  document.querySelectorAll("#itemsTable tbody tr").forEach(row => {
    const qty = parseFloat(row.children[1].firstChild.value) || 0;
    const price = parseFloat(row.children[2].firstChild.value) || 0;
    const total = qty * price;
    row.children[3].innerText = "$" + total.toFixed(2);
    subtotal += total;
  });

  const taxRate = parseFloat(document.getElementById("taxRate").value) || 0;
  const tax = subtotal * (taxRate / 100);
  const total = subtotal + tax;

  document.getElementById("eSubtotal").innerText = subtotal.toFixed(2);
  document.getElementById("eTax").innerText = tax.toFixed(2);
  document.getElementById("eTotal").innerText = total.toFixed(2);

  return { subtotal, tax, total };
}

document.getElementById("taxRate").addEventListener("input", calculate);

function showPreview() {
  const { subtotal, tax, total } = calculate();

  document.getElementById("pInvoiceNumber").innerText = invoiceNumber.value;
  document.getElementById("pInvoiceDate").innerText = invoiceDate.value;
  document.getElementById("pDueDate").innerText = dueDate.value;

  document.getElementById("pCustomerName").innerText = customerName.value;
  document.getElementById("pCustomerAddress").innerText = customerAddress.value;
  document.getElementById("pCustomerEmail").innerText = customerEmail.value;

  const pItems = document.getElementById("pItems");
  pItems.innerHTML = "";

  document.querySelectorAll("#itemsTable tbody tr").forEach(row => {
    const desc = row.children[0].firstChild.value;
    const qty = row.children[1].firstChild.value;
    const price = parseFloat(row.children[2].firstChild.value).toFixed(2);
    const lineTotal = (qty * price).toFixed(2);

    const newRow = document.createElement("tr");
    newRow.innerHTML = `
      <td>${desc}</td>
      <td class="right">${qty}</td>
      <td class="right">$${price}</td>
      <td class="right">$${lineTotal}</td>
    `;
    pItems.appendChild(newRow);
  });

  document.getElementById("pSubtotal").innerText = subtotal.toFixed(2);
  document.getElementById("pTax").innerText = tax.toFixed(2);
  document.getElementById("pTotal").innerText = total.toFixed(2);

  document.getElementById("editor").classList.add("hidden");
  document.getElementById("preview").classList.remove("hidden");

  localStorage.setItem("invoiceCounter", parseInt(invoiceCounter) + 1);
}

function showEditor() {
  document.getElementById("preview").classList.add("hidden");
  document.getElementById("editor").classList.remove("hidden");
}

addItem();

</script>

</body>
</html>
